import{A as p}from"./constants-Cio_5RR6.js";async function u(){try{const e=new URL(p);e.searchParams.append("_active","true"),e.searchParams.append("_bids","true"),e.searchParams.append("_seller","true"),e.searchParams.append("sort","created"),e.searchParams.append("sortOrder","desc");const t=await fetch(e);if(!t.ok)throw new Error(`Failed to fetch listings: ${t.statusText}`);return await t.json()}catch(e){throw console.error("Error in fetchAllListings:",e),e}}async function g(e){try{const t=new URL(p);t.searchParams.append("title",e),t.searchParams.append("_active","true"),t.searchParams.append("_bids","true"),t.searchParams.append("_seller","true"),t.searchParams.append("sort","created"),t.searchParams.append("sortOrder","desc");const a=await fetch(t);if(!a.ok)throw new Error(`Failed to fetch search results: ${a.statusText}`);return await a.json()}catch(t){throw console.error("Error in searchListings:",t),t}}async function f(){const e=document.getElementById("posts-container"),t=document.getElementById("search-bar");if(!e||!t){console.error("Error: Required DOM elements not found.");return}async function a(r=""){console.log("Search query:",r),e.innerHTML='<div class="flex justify-center">Laster innhold<p class="loader border-t-4 border-secondary border-solid rounded-full w-8 h-8 animate-spin"></p></div>';try{const n=r?await g(r):await u();console.log("API Response:",n);const i=n.data;if(!i||i.length===0){e.innerHTML=`<p>No listings found for "${r}".</p>`;return}const l=r?i.filter(s=>s.title.toLowerCase().includes(r.toLowerCase())):i;if(l.length===0){e.innerHTML=`<p>Ingen søk på "${r}".</p>`;return}const m=l.sort((s,d)=>{const c=new Date(s.updated).getTime();return new Date(d.updated).getTime()-c});e.className="grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-3 p-6 max-w-[1400px] m-auto",e.innerHTML="",m.forEach(s=>{const d=s.bids?.length?Math.max(...s.bids.map(h=>h.amount)):0,c=s.media&&s.media.length>0?`<img src="${s.media[0].url}" alt="${s.media[0].alt||"Listing Image"}" class="w-full h-64 object-cover rounded-t-lg">`:'<div class="w-full h-64 bg-gray-200 rounded-t-lg flex items-center justify-center">Ingen bilde</div>',o=document.createElement("a");o.href=`/annonse/?id=${s.id}`,o.className="bg-containers shadow-md rounded-lg flex flex-col min-w-[300px] hover:shadow-lg transition-shadow duration-300",o.innerHTML=`
            <div class="relative">
              ${c}
            </div>
            <div class="p-4 flex flex-col justify-between flex-grow">
              <h2 class="text-lg font-bold mb-2 line-clamp-3">${s.title}</h2>
              <p class="text-sm text-gray-600 mb-4 line-clamp-3">${s.description||""}</p>
              <div class="flex items-center justify-between">
                <button class="bg-secondary text-white text-sm font-medium px-4 py-2 rounded hover:bg-grey-700">
                  GI BUD
                </button>
                <p class="text-sm font-medium text-secondary">Høyeste bud: ${d} NOK</p>
              </div>
            </div>
          `,e.appendChild(o)})}catch(n){console.error("Error displaying listings:",n),e.innerHTML="<p>Failed to load listings. Please try again later.</p>"}}await a(),t.addEventListener("input",r=>{const n=r.target.value.trim();a(n)})}f();
