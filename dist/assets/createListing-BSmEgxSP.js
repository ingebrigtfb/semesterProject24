import{A as u}from"./constants-Cio_5RR6.js";import{h as d}from"./headers-7jRSljoY.js";async function g(o){const r=localStorage.getItem("token");if(!r)throw new Error("No auth token found. Please log in.");try{const t=await fetch(u,{method:"POST",headers:d(r),body:JSON.stringify(o)});if(console.log("Create Listing Response:",t),!t.ok){const n=await t.json();throw console.error("Error Details:",n),new Error(`Failed to create listing: ${n.message||"Unknown error"}`)}const i=await t.json();return console.log("Parsed Response Data:",i),i}catch(t){throw console.error("Error in createListing:",t),t}}async function m(o){o.preventDefault();const r=o.target,t=document.querySelectorAll(".image-field"),i=Array.from(t).map(e=>{const a=e.querySelector("input[name='media-url']").value.trim(),c=e.querySelector("input[name='media-alt']").value.trim();return{url:a,alt:c||void 0}}).filter(e=>e.url),n=r.querySelector("input[name='endsAt']").value.trim(),l=n?new Date(`${n}:00`).toISOString():null,s={title:r.querySelector("input[name='title']").value.trim(),description:r.querySelector("textarea[name='description']").value.trim(),endsAt:l,media:i};console.log("Final Listing Data:",s);try{const e=await g(s);console.log("Created Listing:",e);const a=e.data?.id;if(a)alert("Listing created successfully!"),window.location.href=`/annonse/?id=${a}`;else throw new Error("Listing ID not found in the response.")}catch(e){console.error("Error creating listing:",e),alert(`Error creating listing: ${e.message}`)}}document.getElementById("create-listing-form").addEventListener("submit",m);
